# My MSc Thesis project on Anomaly Detection in Network Traffic with the use of Multivariate State Machines
This repository contains all the code related to the work I have done for my MSc thesis during the last 9 months of my master studies in Computer Science at TU Delft. In this project, an end-to-end detection pipeline for identifying malicious (or anomalous) behavior in NetFlow-based traffic based on the extraction of multivariate behavioral profiles from the benign traffic is implemented. In particular, the functionality of the proposed detection system is founded on the assumption that, if models are extracted from the normal operation of a monitored system, then any behavior rejected from these models is considered an anomaly, thus it could be potentially associated to malicious activity.

To do so, state-of-the-art automata learning algorithms are used to extract multivariate state machines from the benign NetFlow traces of certain network entities, like hosts and connections. As a result, each state machine can be perceived as a communication profile capturing the benign behavior of the corresponding network entity. Each state of the derived state machines can be further perceived as a temporal cluster of the general behavior of the corresponding network entity, so that underlying temporal relations can be captured by the model. Subsequently, the benign traces are replayed on each corresponding state machine, and an anomaly detection model is learnt in each state. As a result, each state can be used as a detection predictor when unseen NetFlow traces are replayed on the associated state machine. Finally, each fitted multivariate state machine is utilized as a benign communication profile providing predictions on unseen sets of NetFlow traces, with the benignity of each set depending on the extent of its match to the extracted benign profiles.
